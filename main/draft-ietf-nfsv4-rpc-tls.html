<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Towards Remote Procedure Call Encryption By Default</title>
<meta content="Trond Myklebust" name="author">
<meta content="Charles Lever" name="author">
<meta content="
       
This document describes a mechanism that,
through the use of opportunistic Transport Layer Security (TLS),
enables encryption of in-transit Remote Procedure Call (RPC) transactions
while interoperating with ONC RPC implementations
that do not support this mechanism.
This document updates RFC 5531.
 
    " name="description">
<meta content="xml2rfc 2.45.3" name="generator">
<meta content="draft-ietf-nfsv4-rpc-tls-latest" name="ietf.draft">
<link href="draft-ietf-nfsv4-rpc-tls.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  text-align: left;
  background-color: #eee;
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 1em;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">RPC-Over-TLS</td>
<td class="right">June 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Myklebust &amp; Lever</td>
<td class="center">Expires 1 January 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network File System Version 4</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-nfsv4-rpc-tls-latest</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5531" class="eref">5531</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-06-30" class="published">30 June 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-01-01">1 January 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Myklebust</div>
<div class="org">Hammerspace</div>
</div>
<div class="author">
      <div class="author-name">C. Lever, <span class="editor">Ed.</span>
</div>
<div class="org">Oracle</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Towards Remote Procedure Call Encryption By Default</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
This document describes a mechanism that,
through the use of opportunistic Transport Layer Security (TLS),
enables encryption of in-transit Remote Procedure Call (RPC) transactions
while interoperating with ONC RPC implementations
that do not support this mechanism.
This document updates RFC 5531.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <p id="section-note.1-1">
Discussion of this draft takes place
on the NFSv4 working group mailing list (nfsv4@ietf.org),
which is archived at
<span><a href="https://mailarchive.ietf.org/arch/browse/nfsv4/">https://mailarchive.ietf.org/arch/browse/nfsv4/</a></span>.
Working Group information can be found at
<span><a href="https://datatracker.ietf.org/wg/nfsv4/about/">https://datatracker.ietf.org/wg/nfsv4/about/</a></span>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">This note is to be removed before publishing as an RFC.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
The source for this draft is maintained in GitHub.
Suggested changes should be submitted as pull requests at
<span><a href="https://github.com/chucklever/i-d-rpc-tls">https://github.com/chucklever/i-d-rpc-tls</a></span>.
Instructions are on that page as well.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 January 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-rpc-over-tls-in-operation" class="xref">RPC-Over-TLS in Operation</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-discovering-server-side-tls" class="xref">Discovering Server-side TLS Support</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-authentication" class="xref">Authentication</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-using-tls-with-rpcsec-gss" class="xref">Using TLS with RPCSEC GSS</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-tls-requirements" class="xref">TLS Requirements</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-base-transport-consideratio" class="xref">Base Transport Considerations</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-protected-operation-on-tcp" class="xref">Protected Operation on TCP</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-protected-operation-on-udp" class="xref">Protected Operation on UDP</a><a href="#section-toc.1-1.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-protected-operation-on-othe" class="xref">Protected Operation on Other Transports</a><a href="#section-toc.1-1.5.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-tls-peer-authentication" class="xref">TLS Peer Authentication</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-x509-certificates-using-pki" class="xref">X.509 Certificates Using PKIX trust</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-x509-certificates-using-fin" class="xref">X.509 Certificates Using Fingerprints</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-pre-shared-keys" class="xref">Pre-Shared Keys</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-token-binding" class="xref">Token Binding</a><a href="#section-toc.1-1.5.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-desy-nfs-server" class="xref">DESY NFS server</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-hammerspace-nfs-server" class="xref">Hammerspace NFS server</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-linux-nfs-server-and-client" class="xref">Linux NFS server and client</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-freebsd-nfs-server-and-clie" class="xref">FreeBSD NFS server and client</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-limitations-of-an-opportuni" class="xref">Limitations of an Opportunistic Approach</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-striptls-attacks" class="xref">STRIPTLS Attacks</a><a href="#section-toc.1-1.7.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="xref">7.1.2</a>.  <a href="#name-privacy-leakage-before-sess" class="xref">Privacy Leakage Before Session Establishment</a><a href="#section-toc.1-1.7.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-tls-identity-management-on-" class="xref">TLS Identity Management on Clients</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-security-considerations-for" class="xref">Security Considerations for AUTH_SYS on TLS</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-best-security-policy-practi" class="xref">Best Security Policy Practices</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-rpc-authentication-flavor" class="xref">RPC Authentication Flavor</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-alpn-identifier-for-sunrpc" class="xref">ALPN Identifier for SUNRPC</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-known-weaknesses-of-the-aut" class="xref">Known Weaknesses of the AUTH_SYS Authentication Flavor</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="section_8F035331-8EB8-4FBC-973A-673FBA5FE952">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
In 2014 the IETF published
a document entitled "Pervasive Monitoring Is an Attack"
<span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>,
which recognized that unauthorized observation
of network traffic had become widespread
and
was a subversive threat
to all who make use of the Internet at large.
It strongly recommended that newly defined Internet protocols
should make a genuine effort to mitigate monitoring attacks.
Typically this mitigation is done by encrypting data in transit.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
The Remote Procedure Call version 2 protocol
has been a Proposed Standard for three decades
(see
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
and its antecedents).
Over twenty years ago,
Eisler et al. first introduced RPCSEC GSS
as an in-transit encryption mechanism for RPC
<span>[<a href="#RFC2203" class="xref">RFC2203</a>]</span>.
However, experience has shown
that RPCSEC GSS with in-transit encryption
can be challenging to use in practice:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
Parts of each RPC header remain in clear-text,
constituting a significant security exposure.<a href="#section-1-3.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-1-3.2">
Offloading the GSS privacy service is not practical
in large multi-user deployments
since each message is encrypted using a key based
on the issuing RPC user.<a href="#section-1-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1-4">
However strong GSS-provided confidentiality is,
it cannot provide any security if the challenges
of using it result in choosing not to deploy it at all.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">
Moreover, the use of AUTH_SYS
remains common despite the adverse effects
that acceptance of UIDs and GIDs
from unauthenticated clients brings with it.
Continued use is in part because:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-6.1">
Per-client deployment and administrative costs
are not scalable.
Administrators must provide keying material
for each RPC client, including transient clients.<a href="#section-1-6.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-1-6.2">
Host identity management and user identity management
must be enforced in the same security realm.
In certain environments,
different authorities might be responsible
for provisioning client systems
versus
provisioning new users.<a href="#section-1-6.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1-7">
The alternative described in the current document is
to employ a transport layer security mechanism
that can protect the confidentiality of each RPC connection
transparently to RPC and upper-layer protocols.
The Transport Layer Security protocol
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
(TLS) is a well-established Internet building block
that protects many standard Internet protocols
such as the Hypertext Transport Protocol (HTTP)
<span>[<a href="#RFC2818" class="xref">RFC2818</a>]</span>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">
Encrypting at the RPC transport layer accords several significant benefits:<a href="#section-1-8" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1-9">
        <dt id="section-1-9.1">Encryption By Default:</dt>
<dd id="section-1-9.2">
Transport encryption can be enabled
without additional administrative tasks such as
identifying client systems to a trust authority,
generating additional keying material,
or
provisioning a secure network tunnel.<a href="#section-1-9.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-1-9.3">Encryption Offload:</dt>
<dd id="section-1-9.4">
Hardware support for the GSS privacy service has not appeared in the marketplace.
However, the use of a well-established transport encryption mechanism
that is employed by other ubiquitous network protocols
makes it more likely that encryption offload for RPC
is practicable.<a href="#section-1-9.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-1-9.5">Securing AUTH_SYS:</dt>
<dd id="section-1-9.6">
Most critically, transport encryption can
significantly reduce several security issues
inherent in the current widespread use of AUTH_SYS
(i.e., acceptance of UIDs and GIDs
generated by an unauthenticated client).<a href="#section-1-9.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-1-9.7">Decoupled User and Host Identities:</dt>
<dd id="section-1-9.8">
TLS can be used to authenticate peer hosts
while other security mechanisms can handle user authentication.<a href="#section-1-9.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-1-10">
The current document specifies the implementation of RPC on an encrypted transport
in a manner that is transparent to upper-layer protocols based on RPC.
The imposition of encryption at the transport layer
protects any upper-layer protocol that employs RPC,
without alteration of that protocol.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">
Further,
<a href="#section_2AE49383-E6B2-4830-8407-995FEBF727F2" class="xref">Section 7</a>
of the current document defines policies in line with
<span>[<a href="#RFC7435" class="xref">RFC7435</a>]</span>
which enable RPC-over-TLS to be deployed opportunistically
in environments that contain RPC implementations that do not support TLS.
However, specifications for RPC-based upper-layer protocols
should choose to require even stricter policies that guarantee
encryption
and
host authentication
is used for all RPC transactions.
Enforcing the use of RPC-over-TLS is of particular importance
for existing upper-layer protocols whose security infrastructure is weak.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">
The protocol specification in the current document assumes
that support for RPC, TLS, PKI, GSS-API, and DNSSEC
is already available in an RPC implementation
where TLS support is to be added.<a href="#section-1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_024237C9-5504-49B4-A2D3-2D2A5EFBB967">
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">
The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>",
"<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>",
"<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
"<span class="bcp14">SHOULD NOT</span>",
"<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>"
in this document are to be interpreted
as described in BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
        <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_0EB1100E-DAA8-4B2C-98AE-94258CFDCB1B">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">
This document adopts the terminology introduced in Section 3 of
<span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span>
and assumes a working knowledge of
the Remote Procedure Call (RPC) version 2 protocol
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
and
the Transport Layer Security (TLS) version 1.3 protocol
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
Note also that the NFS community long ago adopted the
use of the term "privacy" from documents such as
<span>[<a href="#RFC2203" class="xref">RFC2203</a>]</span>.
In the current document, the authors use the term
"privacy" only when referring specifically
to the historic GSS privacy service defined in
<span>[<a href="#RFC2203" class="xref">RFC2203</a>]</span>.
Otherwise, the authors use the term "confidentiality",
following the practices of contemporary security communities.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
We adhere to the convention that a "client"
is a network host that actively initiates an association,
and
a "server" is a network host that passively accepts an association request.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">
RPC documentation historically refers to
the authentication of a connecting host as "machine authentication"
or "host authentication".
TLS documentation refers to the same as "peer authentication".
In the current document there is little distinction between these terms.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">
The term "user authentication" in the current document refers specifically
to the RPC caller's credential, provided in the
"cred"
and
"verf"
fields in each RPC Call.<a href="#section-3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_EC3FEED5-1DE0-454B-9AB3-CE47BA901583">
<section id="section-4">
      <h2 id="name-rpc-over-tls-in-operation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-rpc-over-tls-in-operation" class="section-name selfRef">RPC-Over-TLS in Operation</a>
      </h2>
<div id="section_0A03673B-14BA-4228-8A8A-F76AA318CA73">
<section id="section-4.1">
        <h3 id="name-discovering-server-side-tls">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-discovering-server-side-tls" class="section-name selfRef">Discovering Server-side TLS Support</a>
        </h3>
<p id="section-4.1-1">
The mechanism described in the current document
interoperates fully with RPC implementations
that do not support RPC-over-TLS.
Policy settings on the RPC-over-TLS-enabled peer determine
whether RPC operation continues without the use of TLS
or RPC operation is not permitted.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
To achieve this interoperability,
we introduce a new RPC authentication flavor called AUTH_TLS.
The AUTH_TLS authentication flavor signals that the client wants
to initiate TLS negotiation if the server supports it.
Except for the modifications described in this section,
the RPC protocol is unaware of security encapsulation
at the transport layer.
The value of AUTH_TLS is defined in
<a href="#section_2CD51855-CE40-4B8D-A220-F211C477964F" class="xref">Section 8.1</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
An RPC client begins its communication with an RPC server
by selecting a transport and destination port.
The choice of transport and port is
typically based on the RPC program that is to be used.
The RPC client might query the RPC server's rpcbind service
to make this selection.
In all cases, an RPC server <span class="bcp14">MUST</span> listen on the same ports
for (D)TLS-protected RPC programs
as the ports used when (D)TLS is not available.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
To protect RPC traffic to a TCP port,
the RPC client opens a TCP connection to that port
and sends a NULL RPC procedure
with an auth_flavor of AUTH_TLS on that connection.
To protect RPC traffic to a UDP port,
the RPC client sends a UDP datagram to that port
containing a NULL RPC procedure with an auth_flavor of AUTH_TLS.
The mechanism described in the current document
does not support RPC transports other than TCP and UDP.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">
The length of the opaque data constituting the credential
sent in the RPC Call message <span class="bcp14">MUST</span> be zero.
The verifier accompanying the credential <span class="bcp14">MUST</span> be an AUTH_NONE
verifier of length zero.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">
The flavor value of the verifier in the RPC Reply message
received from the server <span class="bcp14">MUST</span> be AUTH_NONE.
The length of the verifier's body field is eight.
The bytes of the verifier's body field encode the ASCII characters
"STARTTLS" as a fixed-length opaque.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">
If the RPC server replies with
a reply_stat of MSG_ACCEPTED
and
an AUTH_NONE verifier containing the "STARTTLS" token,
the client <span class="bcp14">SHOULD</span> proceed with TLS session establishment,
even if the Reply's accept_stat is not SUCCESS.
If the AUTH_TLS probe was done via TCP,
the RPC client <span class="bcp14">MUST</span> send the "ClientHello" message
on the same connection.
If the AUTH_TLS probe was done via UDP,
the RPC client <span class="bcp14">MUST</span> send the "ClientHello" message
to the same UDP destination port.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">
Conversely,
if the Reply's reply_stat is not MSG_ACCEPTED,
if its verifier flavor is not AUTH_NONE,
or if its verifier does not contain the "STARTTLS" token,
the RPC client <span class="bcp14">MUST NOT</span> send a "ClientHello" message.
RPC operation can continue,
however it will be without any confidentiality,
integrity or authentication protection from (D)TLS.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">
If, after a successful RPC AUTH_TLS probe,
the subsequent (D)TLS handshake should fail for any reason,
the RPC client reports this failure
to the upper-layer application
the same way it reports an AUTH_ERROR rejection
from the RPC server.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">
If an RPC client uses the AUTH_TLS authentication flavor
on any procedure other than the NULL procedure,
or an RPC client sends an RPC AUTH_TLS probe within
an existing (D)TLS session,
the RPC server <span class="bcp14">MUST</span> reject that RPC Call by setting
the reply_stat field to MSG_DENIED,
the reject_stat field to AUTH_ERROR,
and
the auth_stat field to AUTH_BADCRED.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1-11">
Once the TLS session handshake is complete,
the RPC client and server have established
a secure channel for communicating.
A successful AUTH_TLS probe on one particular port/transport tuple
never implies RPC-over-TLS is available on that same server
using a different port/transport tuple.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_6EDEF553-C95A-47D7-ABBA-0B537FE3A959">
<section id="section-4.2">
        <h3 id="name-authentication">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-authentication" class="section-name selfRef">Authentication</a>
        </h3>
<p id="section-4.2-1">
Both RPC and TLS have peer and user authentication,
with some overlap in capability between RPC and TLS.
The goal of interoperability with implementations
that do not support TLS requires
limiting the combinations that are allowed
and
precisely specifying the role that each layer plays.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
Each RPC server that supports RPC-over-TLS <span class="bcp14">MUST</span> possess a unique global identity
(e.g., a certificate that is signed by a well-known trust anchor).
Such an RPC server <span class="bcp14">MUST</span> request a TLS peer identity from each client
upon first contact.
There are two different modes of client deployment:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<dl class="dlNewline" id="section-4.2-3">
          <dt id="section-4.2-3.1">Server-only Host Authentication</dt>
<dd id="section-4.2-3.2">
In this type of deployment,
the client can authenticate the server host
using the presented server peer TLS identity,
but the server cannot authenticate the client.
In this situation,
RPC-over-TLS clients are anonymous.
They present no globally unique identifier to the server peer.<a href="#section-4.2-3.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-4.2-3.3">Mutual Host Authentication</dt>
<dd id="section-4.2-3.4">
In this type of deployment,
the client possesses an identity (e.g. a certificate) that is backed by a trusted entity.
As part of the TLS handshake, both peers authenticate using the presented TLS identities.
If authentication of either peer fails,
or
if authorization based on those identities blocks access to the server,
the peers <span class="bcp14">MUST</span> reject the association.<a href="#section-4.2-3.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
<p id="section-4.2-4">
In either of these modes, RPC user authentication is not affected
by the use of transport layer security.
When a client presents a TLS peer identity to an RPC server,
the protocol extension described in the current document
provides no way for the server to know
whether that identity represents one RPC user on that client,
or
is shared amongst many RPC users.
Therefore, a server implementation must not
utilize the remote TLS peer identity for RPC user authentication.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div id="section_12D92596-F310-48C8-A4E0-B6CA038524E5">
<section id="section-4.2.1">
          <h4 id="name-using-tls-with-rpcsec-gss">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-using-tls-with-rpcsec-gss" class="section-name selfRef">Using TLS with RPCSEC GSS</a>
          </h4>
<p id="section-4.2.1-1">
To use GSS, an RPC server has to possess a GSS service principal.
On a TLS session, GSS mutual (peer) authentication occurs as usual,
but only after a TLS session has been established for communication.
Authentication of GSS users is unchanged by the use of TLS.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">
RPCSEC GSS can also perform
per-request integrity or confidentiality protection.
When operating over a TLS session, these GSS services become redundant.
An RPC implementation capable of concurrently using TLS and RPCSEC GSS
can use GSS channel binding, as defined in
<span>[<a href="#RFC5056" class="xref">RFC5056</a>]</span>,
to determine when an underlying transport provides a sufficient degree
of confidentiality.
Channel bindings for the TLS channel type are defined in
<span>[<a href="#RFC5929" class="xref">RFC5929</a>]</span>.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="section_D93526DA-7B9D-419B-BE84-4AD8DA48577E">
<section id="section-5">
      <h2 id="name-tls-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-tls-requirements" class="section-name selfRef">TLS Requirements</a>
      </h2>
<p id="section-5-1">
When peers negotiate a TLS session that is to transport RPC,
the following restrictions apply:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
Implementations <span class="bcp14">MUST NOT</span> negotiate TLS versions prior to v1.3
(for TLS
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
or DTLS
<span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>
respectively).
Support for mandatory-to-implement ciphersuites
for the negotiated TLS version is <span class="bcp14">REQUIRED</span>.<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5-2.2">
Implementations <span class="bcp14">MUST</span> support certificate-based mutual authentication.
Support for TLS-PSK mutual authentication
<span>[<a href="#RFC4279" class="xref">RFC4279</a>]</span>
is <span class="bcp14">OPTIONAL</span>.
See
<a href="#section_6EDEF553-C95A-47D7-ABBA-0B537FE3A959" class="xref">Section 4.2</a>
for further details.<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5-2.3">
Negotiation of a ciphersuite providing confidentiality as
well as integrity protection is <span class="bcp14">REQUIRED</span>.
Support for and negotiation of compression is <span class="bcp14">OPTIONAL</span>.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5-3">
Client implementations <span class="bcp14">MUST</span> include the
"application_layer_protocol_negotiation(16)" extension
<span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>
in their "ClientHello" message
and <span class="bcp14">MUST</span> include the protocol identifier
defined in
<a href="#section_58905D7A-06B1-4469-964A-DAC607DAC500" class="xref">Section 8.2</a>
in that message's ProtocolNameList value.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">
Similary, in response to the "ClientHello" message,
server implementations <span class="bcp14">MUST</span> include the
"application_layer_protocol_negotiation(16)" extension
<span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>
in their "ServerHello" message
and <span class="bcp14">MUST</span> include only the protocol identifier
defined in
<a href="#section_58905D7A-06B1-4469-964A-DAC607DAC500" class="xref">Section 8.2</a>
in that message's ProtocolNameList value.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">
If the server responds incorrectly
(for instance, if the "ServerHello" message does not conform to the above requirements),
the client <span class="bcp14">MUST NOT</span> establish a TLS session for use with RPC
on this connection.
See
<span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>
for further details about how to form these messages properly.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="section_CC204592-F561-49BD-B1C9-DE0FF7F0E7AB">
<section id="section-5.1">
        <h3 id="name-base-transport-consideratio">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-base-transport-consideratio" class="section-name selfRef">Base Transport Considerations</a>
        </h3>
<p id="section-5.1-1">
There is traditionally a strong association between an RPC program
and a destination port number.
The use of TLS or DTLS does not change that association.
Thus it is frequently --
though not always --
the case that a single TLS session
carries traffic for only one RPC program.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="section_74B43C7E-5ADC-4FBD-B4EA-FF8F470994A8">
<section id="section-5.1.1">
          <h4 id="name-protected-operation-on-tcp">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-protected-operation-on-tcp" class="section-name selfRef">Protected Operation on TCP</a>
          </h4>
<p id="section-5.1.1-1">
The use of the Transport Layer Security (TLS) protocol
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
protects RPC on TCP connections.
Typically,
once an RPC client completes the TCP handshake,
it uses the mechanism described in
<a href="#section_0A03673B-14BA-4228-8A8A-F76AA318CA73" class="xref">Section 4.1</a>
to discover RPC-over-TLS support for that connection.
If spurious traffic appears on a TCP connection
between the initial clear-text AUTH_TLS probe
and
the TLS session handshake,
receivers <span class="bcp14">MUST</span> discard that data without response
and then <span class="bcp14">SHOULD</span> drop the connection.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">
The protocol convention specified in the current document
assumes there can be no more than one concurrent TLS session
per TCP connection.
This is true of current generations of TLS,
but might be different in a future version of TLS.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">
Once a TLS session is established on a TCP connection,
no further clear-text communication can occur on that connection
until the session is terminated.
The use of TLS does not alter RPC record framing used on TCP transports.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">
Furthermore,
if an RPC server responds with PROG_UNAVAIL
to an RPC Call within an established TLS session,
that does not imply that RPC server will subsequently
reject the same RPC program on a different TCP connection.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">
Reverse-direction operation occurs only on connected transports such as TCP
(see Section 2 of
<span>[<a href="#RFC8166" class="xref">RFC8166</a>]</span>).
To protect reverse-direction RPC operations,
the RPC server does not establish a separate TLS session on the TCP connection,
but instead uses the existing TLS session on that connection to protect
these operations.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6">
When operation is complete,
an RPC peer terminates a TLS session by sending a TLS Closure Alert
and may then close the TCP connection.<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_B8BF600E-96DC-4C82-AADF-D593826E9B75">
<section id="section-5.1.2">
          <h4 id="name-protected-operation-on-udp">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-protected-operation-on-udp" class="section-name selfRef">Protected Operation on UDP</a>
          </h4>
<p id="section-5.1.2-1">
RFC Editor:
In the following section,
please replace TBD with the connection_id extension number
that is to be assigned in
<span>[<a href="#I-D.ietf-tls-dtls-connection-id" class="xref">I-D.ietf-tls-dtls-connection-id</a>]</span>.
And, please remove this Editor's Note
before this document is published.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">
RPC over UDP is protected using
the Datagram Transport Layer Security (DTLS) protocol
<span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">
Using DTLS does not introduce
reliable
or
in-order
semantics to RPC on UDP.
Each RPC message <span class="bcp14">MUST</span> fit in a single DTLS record.
DTLS encapsulation has overhead,
which reduces the effective Path MTU (PMTU)
and thus the maximum RPC payload size.
The use of DTLS record replay protection is <span class="bcp14">REQUIRED</span>
when transporting RPC traffic.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">
As soon as a client initializes a UDP socket
for use with an RPC server,
it uses the mechanism described in
<a href="#section_0A03673B-14BA-4228-8A8A-F76AA318CA73" class="xref">Section 4.1</a>
to discover DTLS support for an RPC program on a particular port.
It then negotiates a DTLS session.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">
Multi-homed RPC clients and servers may send protected RPC messages
via network interfaces that were not involved in the handshake that
established the DTLS session.
Therefore, when protecting RPC traffic,
each DTLS handshake <span class="bcp14">MUST</span> include the "connection_id(TBD)" extension
described in Section 9 of
<span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>,
and RPC-on-DTLS peer endpoints <span class="bcp14">MUST</span> provide a ConnectionID
with a non-zero length.
Endpoints implementing RPC programs
that expect a significant number of concurrent clients
<span class="bcp14">SHOULD</span> employ ConnectionIDs of at least 4 bytes in length.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">
Sending a TLS Closure Alert terminates a DTLS session.
Subsequent RPC messages exchanged between the RPC client and server
are no longer protected until a new DTLS session is established.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_BFCC24B1-E6D4-4ABC-A5F3-B71E8E96878F">
<section id="section-5.1.3">
          <h4 id="name-protected-operation-on-othe">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-protected-operation-on-othe" class="section-name selfRef">Protected Operation on Other Transports</a>
          </h4>
<p id="section-5.1.3-1">
Transports that provide intrinsic TLS-level security
(e.g., QUIC)
need to be addressed separately from the current document.
In such cases, the use of TLS is not opportunistic
as it can be for TCP or UDP.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">
RPC-over-RDMA can make use of transport layer security
below the RDMA transport layer
<span>[<a href="#RFC8166" class="xref">RFC8166</a>]</span>.
The exact mechanism is not within the scope of the current document.
Because there might not be other provisions
to exchange client and server certificates,
authentication material exchange
needs to be provided by facilities
within a future version
of the RPC-over-RDMA transport protocol.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_936921ED-67BB-46BF-B316-6740E07F6652">
<section id="section-5.2">
        <h3 id="name-tls-peer-authentication">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-tls-peer-authentication" class="section-name selfRef">TLS Peer Authentication</a>
        </h3>
<p id="section-5.2-1">
TLS can perform peer authentication
using any of the following mechanisms:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="section_7A68F518-2C02-4705-8218-4F13E51372F4">
<section id="section-5.2.1">
          <h4 id="name-x509-certificates-using-pki">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-x509-certificates-using-pki" class="section-name selfRef">X.509 Certificates Using PKIX trust</a>
          </h4>
<p id="section-5.2.1-1">
Implementations are <span class="bcp14">REQUIRED</span> to support this mechanism.
In this mode, the tuple
(serial number of the presented certificate; Issuer)
uniquely identifies the RPC peer.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">
X.509 certificates are specified in
<span>[<a href="#X.509" class="xref">X.509</a>]</span>
and extended in
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-3.1">
Implementations <span class="bcp14">MUST</span> allow the configuration
of a list of trusted Certification Authorities
for authorizing incoming connections.<a href="#section-5.2.1-3.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.2">
Certificate validation <span class="bcp14">MUST</span> include the verification rules as per
<span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-5.2.1-3.2" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.3">
Implementations <span class="bcp14">SHOULD</span> indicate their trusted Certification
Authorities (CAs).<a href="#section-5.2.1-3.3" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.4">
Peer validation always includes a check
on whether the locally configured expected
DNS name
or
IP address of the server that is contacted
matches its presented certificate.
DNS names and IP addresses can be contained
in the Common Name (CN) or subjectAltName entries.
For verification, only one of these entries is to be considered.
The following precedence applies:
for DNS name validation, subjectAltName:DNS has precedence over CN;
for IP address validation, subjectAltName:iPAddress has precedence over CN.
Implementors of this specification are advised to read Section 6 of
<span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>
for more details on DNS name validation.<a href="#section-5.2.1-3.4" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.5">
For services accessed by their network identifiers (netids) and universal
network addresses (uaddr), the iPAddress subjectAltName <span class="bcp14">SHOULD</span> be present in
the certificate and must exactly match the address represented
by the universal network address.<a href="#section-5.2.1-3.5" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.6">
Implementations <span class="bcp14">MAY</span> allow the configuration
of a set of additional properties of the certificate
to check for a peer's authorization to communicate
(e.g., a set of allowed values in subjectAltName:URI
or a set of allowed X.509v3 Certificate Policies).<a href="#section-5.2.1-3.6" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-3.7">
When the configured trust base changes
(e.g., removal of a CA from the list of trusted CAs;
issuance of a new CRL for a given CA),
implementations <span class="bcp14">MAY</span> renegotiate the TLS session
to reassess the connecting peer's continued authorization.<a href="#section-5.2.1-3.7" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.2.1-4">
Authenticating a connecting entity does not mean
the RPC server necessarily wants to communicate with that client.
For example, if the Issuer is not in a trusted set of Issuers,
the RPC server may decline to perform RPC transactions with this client.
Implementations that want to support a wide variety of trust models
should expose as many details of the presented certificate
to the administrator as possible
so that the administrator can implement the trust model.
As a suggestion, at least the following parameters
of the X.509 client certificate <span class="bcp14">SHOULD</span> be exposed:<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1-5.1">
Originating IP address<a href="#section-5.2.1-5.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.2">
Certificate Fingerprint<a href="#section-5.2.1-5.2" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.3">
Issuer<a href="#section-5.2.1-5.3" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.4">
Subject<a href="#section-5.2.1-5.4" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.5">
all X.509v3 Extended Key Usage<a href="#section-5.2.1-5.5" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.6">
all X.509v3 Subject Alternative Name<a href="#section-5.2.1-5.6" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.1-5.7">
all X.509v3 Certificate Policies<a href="#section-5.2.1-5.7" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="section_15B9BEE9-9D2F-49B7-900E-0BA9BCE9CB27">
<section id="section-5.2.2">
          <h4 id="name-x509-certificates-using-fin">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-x509-certificates-using-fin" class="section-name selfRef">X.509 Certificates Using Fingerprints</a>
          </h4>
<p id="section-5.2.2-1">
This mechanism is <span class="bcp14">OPTIONAL</span> to implement.
In this mode, the fingerprint of a certificate uniquely identifies the RPC peer.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">
A "fingerprint" is typically defined as
a cryptographic digest of the Distinguished Encoding Rules (DER) form
<span>[<a href="#X.690" class="xref">X.690</a>]</span>
of an X.509v3 certificate
<span>[<a href="#X.509" class="xref">X.509</a>]</span>.
Implementations <span class="bcp14">SHOULD</span> allow the configuration
of a list of trusted certificates that is indexed by fingerprint.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_6DA9ED5F-BAD9-4126-95B7-E2331655A01E">
<section id="section-5.2.3">
          <h4 id="name-pre-shared-keys">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-pre-shared-keys" class="section-name selfRef">Pre-Shared Keys</a>
          </h4>
<p id="section-5.2.3-1">
This mechanism is <span class="bcp14">OPTIONAL</span> to implement.
In this mode, the RPC peer is uniquely identified
by keying material that has been shared out-of-band
or
by a previous TLS-protected connection (see Section 2.2 of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>).
At least the following parameters of the TLS connection <span class="bcp14">SHOULD</span> be exposed:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1">
Originating IP address<a href="#section-5.2.3-2.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-5.2.3-2.2">
TLS Identifier<a href="#section-5.2.3-2.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="section_CBA3E016-B160-4C37-85CA-8D467A6AFE83">
<section id="section-5.2.4">
          <h4 id="name-token-binding">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-token-binding" class="section-name selfRef">Token Binding</a>
          </h4>
<p id="section-5.2.4-1">
This mechanism is <span class="bcp14">OPTIONAL</span> to implement.
In this mode, a token uniquely identifies the RPC peer.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">
Versions of TLS after TLS 1.2 contain a token binding mechanism
that is more secure than using certificates.
This mechanism is detailed in
<span>[<a href="#RFC8471" class="xref">RFC8471</a>]</span>.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="section_88BBA4D6-ED42-4FE6-A208-9D277B68729A">
<section id="section-6">
      <h2 id="name-implementation-status">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-6-1">This section is to be removed before publishing as an RFC.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
This section records the status of known implementations of the
protocol defined by this specification at the time of posting of
this Internet-Draft, and is based on a proposal described in
<span>[<a href="#RFC7942" class="xref">RFC7942</a>]</span>.
The description of implementations in this section is
intended to assist the IETF in its decision processes in
progressing drafts to RFCs.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
Please note that the listing of any individual implementation here
does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information
presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a
catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="section_94AA7844-E393-4353-A35D-DA01D13C909B">
<section id="section-6.1">
        <h3 id="name-desy-nfs-server">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-desy-nfs-server" class="section-name selfRef">DESY NFS server</a>
        </h3>
<dl class="dlParallel" id="section-6.1-1">
          <dt id="section-6.1-1.1">Organization:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.2">
DESY<a href="#section-6.1-1.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.1-1.3">URL:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.4">
            <span><a href="https://desy.de">https://desy.de</a></span><a href="#section-6.1-1.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.1-1.5">Maturity:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.6">
Implementation will be based on mature versions of the current document.<a href="#section-6.1-1.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.1-1.7">Coverage:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.8">
The bulk of this specification is implemented including DTLS.<a href="#section-6.1-1.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.1-1.9">Licensing:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.10">
LGPL<a href="#section-6.1-1.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.1-1.11">Implementation experience:</dt>
<dd style="margin-left: 5.5em" id="section-6.1-1.12">
The implementer has read and commented on the current document.<a href="#section-6.1-1.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_B387F281-958F-470D-B4D4-1D85907B89F1">
<section id="section-6.2">
        <h3 id="name-hammerspace-nfs-server">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-hammerspace-nfs-server" class="section-name selfRef">Hammerspace NFS server</a>
        </h3>
<dl class="dlParallel" id="section-6.2-1">
          <dt id="section-6.2-1.1">Organization:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.2">
Hammerspace<a href="#section-6.2-1.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.2-1.3">URL:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.4">
            <span><a href="https://hammerspace.com">https://hammerspace.com</a></span><a href="#section-6.2-1.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.2-1.5">Maturity:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.6">
Prototype software based on early versions of the current document.<a href="#section-6.2-1.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.2-1.7">Coverage:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.8">
The bulk of this specification is implemented.
The use of DTLS functionality is not implemented.<a href="#section-6.2-1.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.2-1.9">Licensing:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.10">
Proprietary<a href="#section-6.2-1.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.2-1.11">Implementation experience:</dt>
<dd style="margin-left: 5.5em" id="section-6.2-1.12">
No comments from implementors.<a href="#section-6.2-1.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_BF03B3A2-4483-4404-9E7A-F60FCD850F31">
<section id="section-6.3">
        <h3 id="name-linux-nfs-server-and-client">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-linux-nfs-server-and-client" class="section-name selfRef">Linux NFS server and client</a>
        </h3>
<dl class="dlParallel" id="section-6.3-1">
          <dt id="section-6.3-1.1">Organization:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.2">
The Linux Foundation<a href="#section-6.3-1.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.3-1.3">URL:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.4">
            <span><a href="https://www.kernel.org">https://www.kernel.org</a></span><a href="#section-6.3-1.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.3-1.5">Maturity:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.6">
Prototype software based on early versions of the current document.<a href="#section-6.3-1.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.3-1.7">Coverage:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.8">
The bulk of this specification has yet to be implemented.
The use of DTLS functionality is not planned.<a href="#section-6.3-1.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.3-1.9">Licensing:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.10">
GPLv2<a href="#section-6.3-1.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.3-1.11">Implementation experience:</dt>
<dd style="margin-left: 5.5em" id="section-6.3-1.12">
No comments from the implementor.<a href="#section-6.3-1.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_86689813-E907-4046-ADF1-58E2BF668546">
<section id="section-6.4">
        <h3 id="name-freebsd-nfs-server-and-clie">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-freebsd-nfs-server-and-clie" class="section-name selfRef">FreeBSD NFS server and client</a>
        </h3>
<dl class="dlParallel" id="section-6.4-1">
          <dt id="section-6.4-1.1">Organization:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.2">
The FreeBSD Project<a href="#section-6.4-1.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.4-1.3">URL:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.4">
            <span><a href="https://www.freebsd.org">https://www.freebsd.org</a></span><a href="#section-6.4-1.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.4-1.5">Maturity:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.6">
Prototype software based on early versions of the current document.<a href="#section-6.4-1.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.4-1.7">Coverage:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.8">
The bulk of this specification is implemented.
The use of DTLS functionality is not planned.<a href="#section-6.4-1.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.4-1.9">Licensing:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.10">
BSD<a href="#section-6.4-1.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-6.4-1.11">Implementation experience:</dt>
<dd style="margin-left: 5.5em" id="section-6.4-1.12">
Implementers have read and commented on the current document.<a href="#section-6.4-1.12" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="section_2AE49383-E6B2-4830-8407-995FEBF727F2">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">
One purpose of the mechanism described in the current document
is to protect RPC-based applications against threats
to the confidentiality of RPC transactions
and
RPC user identities.
A taxonomy of these threats appears in Section 5 of
<span>[<a href="#RFC6973" class="xref">RFC6973</a>]</span>.
Also, Section 6 of
<span>[<a href="#RFC7525" class="xref">RFC7525</a>]</span>
contains a detailed discussion
of technologies used in conjunction with TLS.
Implementers should familiarize themselves with these materials.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="section_51737BB5-2B65-441E-AD1D-7EBF5123C079">
<section id="section-7.1">
        <h3 id="name-limitations-of-an-opportuni">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-limitations-of-an-opportuni" class="section-name selfRef">Limitations of an Opportunistic Approach</a>
        </h3>
<p id="section-7.1-1">
The purpose of using an explicitly opportunistic approach
is to enable interoperation
with implementations that do not support RPC-over-TLS.
A range of options is allowed by this approach,
from "no peer authentication or encryption"
to
"server-only authentication with encryption"
to
"mutual authentication with encryption".
The actual security level may indeed
be selected based on policy and without user intervention.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">
In environments where interoperability is a priority,
the security benefits of TLS are partially or entirely waived.
Implementations of the mechanism described in the current document
must take care to accurately represent to all RPC consumers
the level of security that is actually in effect,
and are <span class="bcp14">REQUIRED</span> to provide an audit log
of RPC-over-TLS security mode selection.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">
In all other cases,
the adoption, implementation, and deployment of
RPC-based upper-layer protocols that enforce the use of
TLS authentication and encryption
(when similar RPCSEC GSS services are not in use)
is strongly encouraged.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<div id="section_8894BDD2-0E0B-47A3-A2CB-70E4D93B55B0">
<section id="section-7.1.1">
          <h4 id="name-striptls-attacks">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-striptls-attacks" class="section-name selfRef">STRIPTLS Attacks</a>
          </h4>
<p id="section-7.1.1-1">
A classic form of attack on network protocols that initiate an association
in plain-text to discover support for TLS is a man-in-the-middle
that alters the plain-text handshake to make it appear as though
TLS support is not available on one or both peers.
Clients implementers can choose from the following to mitigate
STRIPTLS attacks:<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.1-2.1">
A TLSA record
<span>[<a href="#RFC6698" class="xref">RFC6698</a>]</span>
can alert clients that TLS is expected to work,
and provide a binding of hostname to X.509 identity.
If TLS cannot be negotiated or authentication fails,
the client disconnects and reports the problem.<a href="#section-7.1.1-2.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-7.1.1-2.2">
Client security policy can require
that a TLS session is established on every connection.
If an attacker spoofs the handshake,
the client disconnects and reports the problem.
If TLSA records are not available, this approach is strongly encouraged.<a href="#section-7.1.1-2.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="section_9C03417D-1D3D-4D43-BC43-6F7387736AF7">
<section id="section-7.1.2">
          <h4 id="name-privacy-leakage-before-sess">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-privacy-leakage-before-sess" class="section-name selfRef">Privacy Leakage Before Session Establishment</a>
          </h4>
<p id="section-7.1.2-1">
As mentioned earlier,
communication between an RPC client and server
appears in the clear on the network
prior to the establishment of a TLS session.
This clear-text information usually includes
transport connection handshake exchanges,
the RPC NULL procedure probing support for TLS,
and the initial parts of TLS session establishment.
Appendix C of
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>
discusses precautions that can mitigate exposure during
the exchange of connnection handshake information
and
TLS certificate material that might enable attackers
to track the RPC client.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">
Any RPC traffic that appears on the network before
a TLS session has been established is vulnerable to
monitoring or undetected modification.
A secure client implementation limits or prevents
any RPC exchanges that are not protected.<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<p id="section-7.1.2-3">
The exception to this edict is
the initial RPC NULL procedure that acts as a STARTTLS message,
which cannot be protected.
This RPC NULL procedure contains no arguments or results,
and the AUTH_TLS authentication flavor it uses
does not contain user information.<a href="#section-7.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="section_B9F8A982-CB0E-40FC-9460-680E89DB0001">
<section id="section-7.2">
        <h3 id="name-tls-identity-management-on-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-tls-identity-management-on-" class="section-name selfRef">TLS Identity Management on Clients</a>
        </h3>
<p id="section-7.2-1">
The goal of the RPC-over-TLS protocol extension
is to hide the content of RPC requests while they are in transit.
The RPC-over-TLS protocol by itself cannot protect
against exposure of a user's RPC requests to other users on the same client.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">
Moreover, client implementations are free to transmit RPC requests
for more than one RPC user using the same TLS session.
Depending on the details of the client RPC implementation,
this means that the client's TLS identity material
is potentially visible to every RPC user that shares a TLS session.
Privileged users may also be able to access this TLS identity.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">
As a result,
client implementations need to carefully segregate
TLS identity material so that local access to it
is restricted to only the local users that are authorized
to perform operations on the remote RPC server.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_552B02A0-F19E-4B46-809C-672A6AE931A1">
<section id="section-7.3">
        <h3 id="name-security-considerations-for">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-security-considerations-for" class="section-name selfRef">Security Considerations for AUTH_SYS on TLS</a>
        </h3>
<p id="section-7.3-1">
Using a TLS-protected transport
when the AUTH_SYS authentication flavor is in use
addresses several longstanding weaknesses in AUTH_SYS
(as detailed in
<a href="#section_C7FB9DB5-5F4F-45AD-8BF7-74FFCA08BEBB" class="xref">Appendix A</a>).
TLS augments AUTH_SYS by providing both
integrity protection and confidentiality
that AUTH_SYS lacks.
TLS protects
data payloads,
RPC headers,
and
user identities
against monitoring and alteration while in transit.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">
TLS guards against in-transit insertion and deletion of RPC messages,
thus ensuring the integrity of the message stream
between RPC client and server.
DTLS does not provide full message stream protection,
but it does enable receivers to reject non-participant messages.
In particular, transport layer encryption plus peer authentication
protects receiving XDR decoders from deserializing untrusted data,
a common coding vulnerability.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">
The use of TLS enables strong authentication
of the communicating RPC peers,
providing a degree of non-repudiation.
When AUTH_SYS is used with TLS,
but the RPC client is unauthenticated,
the RPC server still acts on RPC requests
for which there is no trustworthy authentication.
In-transit traffic is protected, but the RPC client itself
can still misrepresent user identity without server detection.
TLS without authentication is an improvement
from AUTH_SYS without encryption,
but it leaves a critical security exposure.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">
In light of the above,
it is <span class="bcp14">RECOMMENDED</span> that when AUTH_SYS is used,
every RPC client should present host authentication material
to RPC servers to prove that the client is a known one.
The server can then determine whether the UIDs and GIDs
in AUTH_SYS requests from that client can be accepted.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">
The use of TLS does not enable RPC clients to detect compromise
that leads to the impersonation of RPC users.
Also, there continues to be a requirement
that the mapping of 32-bit user and group ID values
to user identities
is the same on both the RPC client and server.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="section_55D006D3-8CA6-4D7F-AF0D-BFB0FFEF7595">
<section id="section-7.4">
        <h3 id="name-best-security-policy-practi">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-best-security-policy-practi" class="section-name selfRef">Best Security Policy Practices</a>
        </h3>
<p id="section-7.4-1">
RPC-over-TLS implementations and deployments
are strongly encouraged to adhere to the following policies
to achieve the strongest possible security with RPC-over-TLS.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">
When using AUTH_NULL or AUTH_SYS,
both peers are required to have
DNS TLSA records
and
certificate material,
and a policy that requires
mutual peer authentication
and
rejection of a connection when host authentication fails.<a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
<li class="normal" id="section-7.4-2.2">
RCPSEC_GSS provides integrity and privacy services
which are redundant when TLS is in use.
These services should be disabled in that case.<a href="#section-7.4-2.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="section_7B126473-2A13-453B-9BCA-66BC11B7B018">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">
RFC Editor: In the following subsections,
please replace RFC-TBD with the RFC number assigned to this document.
And, please remove this Editor's Note
before this document is published.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="section_2CD51855-CE40-4B8D-A220-F211C477964F">
<section id="section-8.1">
        <h3 id="name-rpc-authentication-flavor">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-rpc-authentication-flavor" class="section-name selfRef">RPC Authentication Flavor</a>
        </h3>
<p id="section-8.1-1">
Following Appendix B of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
the authors request a single new entry
in the RPC Authentication Flavor Numbers registry.
The purpose of the new authentication flavor
is to signal the use of TLS with RPC.
This new flavor is not a pseudo-flavor.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">
The fields in the new entry are assigned as follows:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.1-3">
          <dt id="section-8.1-3.1">Identifier String:</dt>
<dd id="section-8.1-3.2">
AUTH_TLS<a href="#section-8.1-3.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.1-3.3">Flavor Name:</dt>
<dd id="section-8.1-3.4">
TLS<a href="#section-8.1-3.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.1-3.5">Value:</dt>
<dd id="section-8.1-3.6">
7<a href="#section-8.1-3.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.1-3.7">Description:</dt>
<dd id="section-8.1-3.8">
Indicates support for RPC-over-TLS.<a href="#section-8.1-3.8" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.1-3.9">Reference:</dt>
<dd id="section-8.1-3.10">
RFC-TBD<a href="#section-8.1-3.10" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="section_58905D7A-06B1-4469-964A-DAC607DAC500">
<section id="section-8.2">
        <h3 id="name-alpn-identifier-for-sunrpc">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-alpn-identifier-for-sunrpc" class="section-name selfRef">ALPN Identifier for SUNRPC</a>
        </h3>
<p id="section-8.2-1">
Following Section 6 of
<span>[<a href="#RFC7301" class="xref">RFC7301</a>]</span>,
the authors request the allocation of the following value
in the "Application-Layer Protocol Negotiation (ALPN) Protocol IDs" registry.
The "sunrpc" string identifies SunRPC when used over TLS.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-8.2-2">
          <dt id="section-8.2-2.1">Protocol:</dt>
<dd id="section-8.2-2.2">
SunRPC<a href="#section-8.2-2.2" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.2-2.3">Identification Sequence:</dt>
<dd id="section-8.2-2.4">
0x73 0x75 0x6e 0x72 0x70 0x63 ("sunrpc")<a href="#section-8.2-2.4" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
<dt id="section-8.2-2.5">Reference:</dt>
<dd id="section-8.2-2.6">
RFC-TBD<a href="#section-8.2-2.6" class="pilcrow">¶</a>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-dtls-connection-id">[I-D.ietf-tls-dtls-connection-id]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and T. Fossati</span>, <span class="refTitle">"Connection Identifiers for DTLS 1.2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls-connection-id-07</span>, <time datetime="2019-10-21">21 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls-connection-id-07">https://tools.ietf.org/html/draft-ietf-tls-dtls-connection-id-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, and N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-38</span>, <time datetime="2020-05-29">29 May 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-tls-dtls13-38">https://tools.ietf.org/html/draft-ietf-tls-dtls13-38</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4279">[RFC4279]</dt>
<dd>
<span class="refAuthor">Eronen, P., Ed.</span><span class="refAuthor"> and H. Tschofenig, Ed.</span>, <span class="refTitle">"Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 4279</span>, <span class="seriesInfo">DOI 10.17487/RFC4279</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4279">https://www.rfc-editor.org/info/rfc4279</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5056">[RFC5056]</dt>
<dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"On the Use of Channel Bindings to Secure Channels"</span>, <span class="seriesInfo">RFC 5056</span>, <span class="seriesInfo">DOI 10.17487/RFC5056</span>, <time datetime="2007-11">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5056">https://www.rfc-editor.org/info/rfc5056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
<dd>
<span class="refAuthor">Cooper, D.</span><span class="refAuthor">, Santesson, S.</span><span class="refAuthor">, Farrell, S.</span><span class="refAuthor">, Boeyen, S.</span><span class="refAuthor">, Housley, R.</span><span class="refAuthor">, and W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[RFC5531]</dt>
<dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time datetime="2009-05">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5531">https://www.rfc-editor.org/info/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5929">[RFC5929]</dt>
<dd>
<span class="refAuthor">Altman, J.</span><span class="refAuthor">, Williams, N.</span><span class="refAuthor">, and L. Zhu</span>, <span class="refTitle">"Channel Bindings for TLS"</span>, <span class="seriesInfo">RFC 5929</span>, <span class="seriesInfo">DOI 10.17487/RFC5929</span>, <time datetime="2010-07">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5929">https://www.rfc-editor.org/info/rfc5929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6125">[RFC6125]</dt>
<dd>
<span class="refAuthor">Saint-Andre, P.</span><span class="refAuthor"> and J. Hodges</span>, <span class="refTitle">"Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 6125</span>, <span class="seriesInfo">DOI 10.17487/RFC6125</span>, <time datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6125">https://www.rfc-editor.org/info/rfc6125</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
<dd>
<span class="refAuthor">Farrell, S.</span><span class="refAuthor"> and H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7301">[RFC7301]</dt>
<dd>
<span class="refAuthor">Friedl, S.</span><span class="refAuthor">, Popov, A.</span><span class="refAuthor">, Langley, A.</span><span class="refAuthor">, and E. Stephan</span>, <span class="refTitle">"Transport Layer Security (TLS) Application-Layer Protocol Negotiation Extension"</span>, <span class="seriesInfo">RFC 7301</span>, <span class="seriesInfo">DOI 10.17487/RFC7301</span>, <time datetime="2014-07">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7301">https://www.rfc-editor.org/info/rfc7301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
<dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor"> and A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.509">[X.509]</dt>
<dd>
<span class="refAuthor">International Telephone and Telegraph Consultative Committee</span>, <span class="refTitle">"ITU-T X.509 - Information technology - The Directory: Public-key and attribute certificate frameworks."</span>, <span class="seriesInfo">ISO/IEC 9594-8</span>, <span class="seriesInfo">CCITT Recommendation X.509</span>, <time datetime="2019-10">October 2019</time>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
<dd>
<span class="refAuthor">International Telephone and Telegraph Consultative Committee</span>, <span class="refTitle">"ITU-T X.690 - Information technology - ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1</span>, <span class="seriesInfo">CCITT Recommendation X.690</span>, <time datetime="2015-08">August 2015</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2203">[RFC2203]</dt>
<dd>
<span class="refAuthor">Eisler, M.</span><span class="refAuthor">, Chiu, A.</span><span class="refAuthor">, and L. Ling</span>, <span class="refTitle">"RPCSEC_GSS Protocol Specification"</span>, <span class="seriesInfo">RFC 2203</span>, <span class="seriesInfo">DOI 10.17487/RFC2203</span>, <time datetime="1997-09">September 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2203">https://www.rfc-editor.org/info/rfc2203</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2818">[RFC2818]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"HTTP Over TLS"</span>, <span class="seriesInfo">RFC 2818</span>, <span class="seriesInfo">DOI 10.17487/RFC2818</span>, <time datetime="2000-05">May 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6698">[RFC6698]</dt>
<dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and J. Schlyter</span>, <span class="refTitle">"The DNS-Based Authentication of Named Entities (DANE) Transport Layer Security (TLS) Protocol: TLSA"</span>, <span class="seriesInfo">RFC 6698</span>, <span class="seriesInfo">DOI 10.17487/RFC6698</span>, <time datetime="2012-08">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6698">https://www.rfc-editor.org/info/rfc6698</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
<dd>
<span class="refAuthor">Cooper, A.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Aboba, B.</span><span class="refAuthor">, Peterson, J.</span><span class="refAuthor">, Morris, J.</span><span class="refAuthor">, Hansen, M.</span><span class="refAuthor">, and R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6973">https://www.rfc-editor.org/info/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7435">[RFC7435]</dt>
<dd>
<span class="refAuthor">Dukhovni, V.</span>, <span class="refTitle">"Opportunistic Security: Some Protection Most of the Time"</span>, <span class="seriesInfo">RFC 7435</span>, <span class="seriesInfo">DOI 10.17487/RFC7435</span>, <time datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7435">https://www.rfc-editor.org/info/rfc7435</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7525">[RFC7525]</dt>
<dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Holz, R.</span><span class="refAuthor">, and P. Saint-Andre</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 7525</span>, <span class="seriesInfo">DOI 10.17487/RFC7525</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7525">https://www.rfc-editor.org/info/rfc7525</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8166">[RFC8166]</dt>
<dd>
<span class="refAuthor">Lever, C., Ed.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and T. Talpey</span>, <span class="refTitle">"Remote Direct Memory Access Transport for Remote Procedure Call Version 1"</span>, <span class="seriesInfo">RFC 8166</span>, <span class="seriesInfo">DOI 10.17487/RFC8166</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8166">https://www.rfc-editor.org/info/rfc8166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8471">[RFC8471]</dt>
<dd>
<span class="refAuthor">Popov, A., Ed.</span><span class="refAuthor">, Nystroem, M.</span><span class="refAuthor">, Balfanz, D.</span><span class="refAuthor">, and J. Hodges</span>, <span class="refTitle">"The Token Binding Protocol Version 1.0"</span>, <span class="seriesInfo">RFC 8471</span>, <span class="seriesInfo">DOI 10.17487/RFC8471</span>, <time datetime="2018-10">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8471">https://www.rfc-editor.org/info/rfc8471</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="section_C7FB9DB5-5F4F-45AD-8BF7-74FFCA08BEBB">
<section id="section-appendix.a">
      <h2 id="name-known-weaknesses-of-the-aut">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-known-weaknesses-of-the-aut" class="section-name selfRef">Known Weaknesses of the AUTH_SYS Authentication Flavor</a>
      </h2>
<p id="section-appendix.a-1">
The ONC RPC protocol, as specified in
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>,
provides several modes of security,
traditionally referred to as "authentication flavors".
Some of these flavors provide much more than an authentication service.
We refer to these as
authentication flavors,
security flavors,
or simply,
flavors.
One of the earliest and most basic flavors is AUTH_SYS,
also known as AUTH_UNIX.
Appendix A of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
specifies AUTH_SYS.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">
AUTH_SYS assumes that the RPC client and server
both use POSIX-style user and group identifiers
(each user and group can be distinctly represented
as a 32-bit unsigned integer).
It also assumes that the client and server
both use the same mapping of user and group to an integer.
One user ID, one primary group ID, and up to 16 supplemental group IDs
are associated with each RPC request.
The combination of these identifies the entity on the client
that is making the request.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<p id="section-appendix.a-3">
A string identifies peers (hosts) in each RPC request.
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
does not specify any requirements for this string
other than that is no longer than 255 octets.
It does not have to be the same from request to request.
Also, it does not have to match the DNS hostname of the sending host.
For these reasons,
even though most implementations fill in their hostname in this field,
receivers typically ignore its content.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<p id="section-appendix.a-4">
Appendix A of
<span>[<a href="#RFC5531" class="xref">RFC5531</a>]</span>
contains a brief explanation of security considerations:<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<blockquote id="section-appendix.a-5">
It should be noted that use of this flavor of authentication does not
guarantee any security for the users or providers of a service, in
itself.  The authentication provided by this scheme can be considered
legitimate only when applications using this scheme and the network
can be secured externally, and privileged transport addresses are
used for the communicating end-points (an example of this is the use
of privileged TCP/UDP ports in UNIX systems -- note that not all
systems enforce privileged transport address mechanisms).<a href="#section-appendix.a-5" class="pilcrow">¶</a>
</blockquote>
<p id="section-appendix.a-6">
It should be clear, therefore, that AUTH_SYS by itself
(i.e., without strong client authentication)
offers little to no communication security:<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-appendix.a-7">
        <li id="section-appendix.a-7.1">
It does not protect the confidentiality or integrity of
RPC requests,
users,
or
payloads,
relying instead on "external" security.<a href="#section-appendix.a-7.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.2">
It does not provide authentication of RPC peer machines,
other than inclusion of an unprotected domain name.<a href="#section-appendix.a-7.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.3">
The use of 32-bit unsigned integers as user and group identifiers
is problematic because these data types are
not cryptographically signed or otherwise verified by any authority.<a href="#section-appendix.a-7.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.4">
Because the user and group ID fields are not integrity-protected,
AUTH_SYS does not provide non-repudiation.<a href="#section-appendix.a-7.4" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="section_4959412F-37AD-42B8-9169-D477148F81A8">
<section id="section-appendix.b">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.b-1">
Special mention goes to
<span class="contact-name">Charles Fisher</span>,
author of
<a href="https://www.linuxjournal.com/content/encrypting-nfsv4-stunnel-tls">
"Encrypting NFSv4 with Stunnel TLS"
</a>.
His article inspired the mechanism described in the current document.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">
Many thanks to
<span class="contact-name">Tigran Mkrtchyan</span>
and
<span class="contact-name">Rick Macklem</span>
for their work on prototype implementations and feedback on the current document.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<p id="section-appendix.b-3">
Thanks to
<span class="contact-name">Derrell Piper</span>
for numerous suggestions that improved both
this simple mechanism
and
the current document's security-related discussion.<a href="#section-appendix.b-3" class="pilcrow">¶</a></p>
<p id="section-appendix.b-4">
Many thanks to
Transport Area Director
<span class="contact-name">Magnus Westerlund</span>
for his sharp questions and careful reading
of the final revisions of the current document.
The text of
<a href="#section_B8BF600E-96DC-4C82-AADF-D593826E9B75" class="xref">Section 5.1.2</a>
is mostly his contribution.<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<p id="section-appendix.b-5">
The authors are additionally grateful to
<span class="contact-name">Bill Baker</span>,
<span class="contact-name">David Black</span>,
<span class="contact-name">Alan DeKok</span>,
<span class="contact-name">Lars Eggert</span>,
<span class="contact-name">Benjamin Kaduk</span>,
<span class="contact-name">Olga Kornievskaia</span>,
<span class="contact-name">Greg Marsden</span>,
<span class="contact-name">Alex McDonald</span>,
<span class="contact-name">Justin Mazzola Paluska</span>,
<span class="contact-name">Tom Talpey</span>,
and
<span class="contact-name">Martin Thomson</span>
for their input and support of this work.<a href="#section-appendix.b-5" class="pilcrow">¶</a></p>
<p id="section-appendix.b-6">
Finally, special thanks to
NFSV4 Working Group Chair and document shepherd
<span class="contact-name">David Noveck</span>,
NFSV4 Working Group Chairs
<span class="contact-name">Spencer Shepler</span>
and
<span class="contact-name">Brian Pawlowski</span>,
and
NFSV4 Working Group Secretary
<span class="contact-name">Thomas Haynes</span>
for their guidance and oversight.<a href="#section-appendix.b-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Trond Myklebust</span></div>
<div dir="auto" class="left"><span class="org">Hammerspace Inc</span></div>
<div dir="auto" class="left"><span class="street-address">4300 El Camino Real Ste 105</span></div>
<div dir="auto" class="left">
<span class="locality">Los Altos</span>, <span class="region">CA</span> <span class="postal-code">94022</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:trond.myklebust@hammerspace.com" class="email">trond.myklebust@hammerspace.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Charles Lever (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Oracle Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chuck.lever@oracle.com" class="email">chuck.lever@oracle.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
